<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Оплата — Hiddify VPN</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<section class="section">
  <h2>Оплата подписки Hiddify VPN</h2>

  <div class="pay-box">
    <h3>Наведите камерой на QR-код</h3>

    <img id="bank-qr" class="pay-qr" src="" alt="QR для оплаты">

    <a id="bank-link" class="btn-main" href="#" target="_blank">
      Перейти в Сбербанк для перевода
    </a>
    <div class="contact-box">
  <h4>После оплаты отправьте данные для получения ключа</h4>

  <input id="firstname" placeholder="Имя *" required>
  <input id="lastname" placeholder="Фамилия *" required>

  <input id="senderphone" placeholder="Номер телефона, с которого оплатили *" required>

  <input id="contactphone" placeholder="Ваш номер для связи *" required>

  <input id="email" placeholder="Email (необязательно)">
  <input id="telegram" placeholder="Telegram или WhatsApp (необязательно)">

  <button class="btn-main" onclick="sendToTelegram()">
    Отправить данные
  </button>

  <p class="contact-note">
    Мы вышлем ключ после подтверждения оплаты.
  </p>
</div>

 <h4>
  После оплаты, пожалуйста, оставьте ваши контактные данные, чтобы мы могли отправить вам ключ доступа.
  Укажите имя, фамилию, номер телефона отправителя и удобный способ связи (WhatsApp/Telegram/MAX).
</h4>

  <input type="hidden" name="source" value="Оплата Hiddify VPN — hiddify.ru.net/pay.html">
 
  <input type="text" name="firstname" placeholder="Имя *" required>

<input type="text" name="lastname" placeholder="Фамилия *" required>

<input type="text" name="sender_phone" placeholder="Номер телефона отправителя (с которого была оплата) *" required>

<input type="text" name="contact_phone" placeholder="Ваш номер телефона для связи *" required>

<input type="email" name="email" placeholder="Email (необязательно)">

<input type="text" name="messenger" placeholder="WhatsApp / Telegram / MAX (необязательно)">

  <button type="submit" class="btn-main">Отправить данные</button>

  <p class="contact-note">
    Мы вышлем ключ и инструкцию после подтверждения оплаты.
  </p>
</form>

  </div>
</section>

<script>
  const banks = [
    {
      name: "Сбербанк (№1)",
      qr: "img/pay1.png",
      link: "https://www.sberbank.com/sms/pbpn?requisiteNumber=79203794100"
    },
    {
      name: "Сбербанк (№2)",
      qr: "img/pay3.png",
      link: "https://www.sberbank.com/sms/pbpn?requisiteNumber=79298791010"
    }
  ];

  let index = sessionStorage.getItem("payBankIndex");
  index = index ? parseInt(index) : 0;

  const bank = banks[index];

  document.getElementById("bank-qr").src = bank.qr;
  document.getElementById("bank-link").href = bank.link;

  index = (index + 1) % banks.length;
  sessionStorage.setItem("payBankIndex", index);
</script>

</body>
  <script>
async function sendToTelegram(formData) {
  const TOKEN = "ВСТАВЬ_СЮДА_ТОКЕН";
  const CHAT_ID = "ВСТАВЬ_СЮДА_CHAT_ID";

  const text =
    "Новая заявка оплаты Hiddify VPN:\n\n" +
    "Имя: " + formData.get("firstname") + "\n" +
    "Фамилия: " + formData.get("lastname") + "\n" +
    "Телефон отправителя: " + formData.get("sender_phone") + "\n" +
    "Телефон для связи: " + formData.get("contact_phone") + "\n" +
    "Email: " + formData.get("email") + "\n" +
    "Мессенджер: " + formData.get("messenger");

  await fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`, {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      chat_id: CHAT_ID,
      text: text
    })
  });
}

document.querySelector(".contact-box").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);
  await sendToTelegram(formData);
  alert("Данные отправлены. Мы скоро вышлем ключ.");
});
</script>

</html>
